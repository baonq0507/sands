import{_ as P}from"./Header-C_d6U9Mw.js";import{F as Q}from"./Footer-DigKJm0u.js";import{i as U}from"./axios-Dkq8iht1.js";import{r as x,s as R,o as j,v as z,b as i,c as d,d as _,w as a,e,g as C,h as p,j as f,k as h,F as y,i as I,u as J,l as B,G as b,t as F,n as O}from"./index-BIJFk_Lq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const V={style:{background:"#fff",padding:"12px",minHeight:"calc(100vh - 170px)"}},W=C("h3",null,"Thông tin người dùng",-1),Y={class:"user_detail"},se={__name:"UserDetail",setup(Z){const l=x({fullname:"",phone:"",email:"",balance:"",createAt:"",updateAt:"",ipAddress:"",role:"",permissions:{user:[],inviteCode:[],game:[],setting:[],requestMoney:[],userBalance:[],settingNoti:[],cskh:[]}}),w={user:[{label:"Tạo mới",value:"create"},{label:"Chỉnh sửa",value:"edit"},{label:"Xóa",value:"delete"},{label:"Xem",value:"view"}],inviteCode:[{label:"Chỉnh sửa",value:"edit"},{label:"Xem",value:"view"}],game:[{label:"Chỉnh sửa",value:"edit"},{label:"Xem",value:"view"}],setting:[{label:"Chỉnh sửa",value:"edit"},{label:"Xem",value:"view"}],requestMoney:[{label:"Chỉnh sửa",value:"edit"},{label:"Xóa",value:"delete"},{label:"Xem",value:"view"}],userBalance:[{label:"Chỉnh sửa",value:"edit"}],settingNoti:[{label:"Chỉnh sửa",value:"edit"},{label:"Xem",value:"view"}],cskh:[{label:"Chỉnh sửa",value:"edit"},{label:"Xem",value:"view"}]},k=R().currentRoute.value.params.id,v=x({user:[],inviteCode:[],game:[],setting:[],requestMoney:[],userBalance:[],settingNoti:[],cskh:[]}),X=n=>{switch(n){case"user":return"Người dùng";case"inviteCode":return"Mã mời";case"game":return"Game";case"setting":return"Cài đặt";case"requestMoney":return"Nạp rút";case"userBalance":return"Cộng trừ tiền";case"settingNoti":return"Cài đặt thông báo";case"cskh":return"Chăm sóc khách hàng";default:return n}};j(()=>{U.get(`/users/${k}`).then(n=>{console.log(n),l.value=n,v.value=n.permissions??{user:[],inviteCode:[],game:[],setting:[],requestMoney:[],userBalance:[],settingNoti:[],cskh:[]}})}),z(()=>l.value,n=>{l.value.balance=n.balance?n.balance.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):0,l.value.createAt=n.createAt?B(n.createAt):"",l.value.updateAt=n.updateAt?B(n.updateAt):""});const S=n=>{!n||isNaN(3)||(l.value.balance=n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))},M=async n=>{console.log("Success:",n);const t={...n,permissions:v.value},s=b.load(1);U.put(`/users/${k}`,t).then(o=>{b.msg("Cập nhật thành công",{icon:1,time:1500})}).catch(o=>{b.msg("Cập nhật thất bại",{icon:2,time:1500})}).finally(()=>{b.close(s)})},q=n=>{console.log("Failed:",n)},$=(n,t)=>{const s=v.value;console.log(s,n,t);try{v.value={...s,[n]:s[n].includes(t)?s[n].filter(o=>o!==t):[...s[n],t]}}catch{}};return(n,t)=>{const s=i("a-input"),o=i("a-form-item"),r=i("a-col"),T=i("a-input-number"),g=i("a-select-option"),N=i("a-select"),D=i("a-checkbox"),E=i("a-checkbox-group"),A=i("a-row"),H=i("a-button"),L=i("a-form"),G=i("a-layout-content"),K=i("a-layout");return d(),_(K,null,{default:a(()=>[e(P,{selectedKeys:["1"]}),e(G,{style:{padding:"20px 50px"}},{default:a(()=>[C("div",V,[W,C("div",Y,[e(L,{layout:"vertical",model:l.value,onFinish:M,onFinishFailed:q},{default:a(()=>[e(A,{gutter:"10"},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(o,{name:"username",label:"Họ và tên"},{default:a(()=>[e(s,{value:l.value.username,"onUpdate:value":t[0]||(t[0]=u=>l.value.username=u),rules:[{required:!0,message:"Vui lòng nhập họ và tên"},{min:6,message:"Họ và tên phải lớn hơn 6 ký tự"}]},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{name:"phone",label:"Số điện thoại"},{default:a(()=>[e(s,{value:l.value.phone,"onUpdate:value":t[1]||(t[1]=u=>l.value.phone=u)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{label:"Email",name:"email",rules:[{type:"email",message:"Email không đúng định dạng"}]},{default:a(()=>[e(s,{value:l.value.email,"onUpdate:value":t[2]||(t[2]=u=>l.value.email=u)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{name:"balance",label:"Số dư"},{default:a(()=>[e(T,{onChange:S,style:{width:"100%"},value:l.value.balance,"onUpdate:value":t[3]||(t[3]=u=>l.value.balance=u),disabled:""},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{name:"role",label:"Quyền"},{default:a(()=>[e(N,{value:l.value.role,"onUpdate:value":t[4]||(t[4]=u=>l.value.role=u),style:{width:"100%"}},{default:a(()=>[e(g,{value:"admin"},{default:a(()=>[p("Quản trị")]),_:1}),e(g,{value:"user"},{default:a(()=>[p("Người dùng")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),l.value.role==="admin"?(d(),_(r,{key:0,span:24},{default:a(()=>[e(A,null,{default:a(()=>[(d(),f(y,null,h(w,(u,c)=>e(r,{span:12,key:c},{default:a(()=>[e(o,{name:"permissions",label:X(c)},{default:a(()=>[e(E,{value:v.value[c],"onUpdate:value":m=>v.value[c]=m},{default:a(()=>[(d(!0),f(y,null,h(u,m=>(d(),_(D,{key:m.value,value:m.value,onChange:ae=>$(c,m.value)},{default:a(()=>[p(F(m.label),1)]),_:2},1032,["value","onChange"]))),128))]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["label"])]),_:2},1024)),64))]),_:1})]),_:1})):I("",!0),e(r,{span:12},{default:a(()=>[e(o,{label:"Ngày tạo"},{default:a(()=>[e(s,{value:l.value.createAt,"onUpdate:value":t[5]||(t[5]=u=>l.value.createAt=u),disabled:""},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{label:"Ngày cập nhật"},{default:a(()=>[e(s,{value:l.value.updateAt,"onUpdate:value":t[6]||(t[6]=u=>l.value.updateAt=u),disabled:""},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{label:"Địa chỉ ip"},{default:a(()=>[e(s,{value:l.value.ipAddress,"onUpdate:value":t[7]||(t[7]=u=>l.value.ipAddress=u),disabled:""},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{label:`Chọn ngân hàng\r
                                `,name:"bankName"},{default:a(()=>[e(N,{value:l.value.bankName,"onUpdate:value":t[8]||(t[8]=u=>l.value.bankName=u)},{default:a(()=>[(d(!0),f(y,null,h(J(O),u=>(d(),_(g,{value:u.short_name,key:u.short_name},{default:a(()=>[p(F(`(${u.short_name}) ${u.name}`),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{label:"Số tài khoản",name:"bankAccountNumber"},{default:a(()=>[e(s,{value:l.value.bankAccountNumber,"onUpdate:value":t[9]||(t[9]=u=>l.value.bankAccountNumber=u)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{label:"Tên tài khoản",name:"bankAccountName"},{default:a(()=>[e(s,{value:l.value.bankAccountName,"onUpdate:value":t[10]||(t[10]=u=>l.value.bankAccountName=u)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(o,null,{default:a(()=>[e(H,{type:"primary","html-type":"submit"},{default:a(()=>[p("Lưu")]),_:1})]),_:1})]),_:1},8,["model"])])])]),_:1}),e(Q)]),_:1})}}};export{se as default};
